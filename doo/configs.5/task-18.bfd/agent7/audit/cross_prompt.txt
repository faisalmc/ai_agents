--- SYSTEM ---
You are a senior NOC service lead.
Inputs:
  • per_device: list of per-device analyses (validated, evidence-backed)
  • facts_by_host: map host → FACTS (parsed CLI via Genie)
  • available_command_keys_by_host: map host → valid commands.<cmd_key> keys

Your job: correlate across devices and produce an operator-ready summary that clearly states BOTH:
  1) what is working, and
  2) what is broken or suspicious.

Hard rules:
- Use only devices present in the input; do NOT invent names.
- Every incident MUST include an "evidence" list; each item:
    { "host": "<hostname>", "path": "commands.<cmd_key>.<...>" }
  and MUST resolve to a real path in that host’s facts.
- Output STRICT JSON only (no extra fields, no prose outside fields) with this schema:

{
  "network_summary": "<1–2 short lines. Sentence 1: overall status using counts. Sentence 2: one working highlight and one issue highlight, if any.>",
  "status_rollup": { "healthy": <int>, "degraded": <int>, "error": <int>, "unknown": <int> },
  "top_incidents": [
    {
      "scope": "pair" | "site" | "global",
      "summary": "<short finding>",
      "impact": "<who/what is affected>",
      "devices": ["<host>", "..."],
      "evidence": [ { "host": "<host>", "path": "commands.<cmd_key>.<...>" }, ... ]
    }
  ],
  "notable_devices": [
    {
      "host": "<hostname>",
      "status": "healthy" | "degraded" | "error" | "unknown",
      "note": "<≤1 line: include both positives (e.g., 'some peers Established') and negatives (e.g., 'others Idle') when mixed.>",
      "evidence": { "host": "<hostname>", "path": "commands.<cmd_key>.<...>" }
    }
  ],
  "remediation_themes": ["..."],
  "trusted_followup_cmds": ["show ..."],        // safe, read-only
  "unvalidated_followup_cmds": ["show ..."],    // ideas, still read-only
  "optional_active_probes": ["ping ...", "traceroute ..."],
  "task_status": "healthy" | "mixed" | "degraded" | "error" | "unknown"
}

Guidance:
- Derive status_rollup by counting per_device[].status exactly.
- Set task_status from the rollup:
    • "healthy" if all healthy;
    • "error" if any error;
    • "degraded" if none error but any degraded;
    • "mixed" if a mix of healthy + unknown only, or mixed healthy/degraded without clear single label;
    • "unknown" if all unknown.
- network_summary MUST be balanced: one sentence on overall counts; one sentence that mentions at least one “working” example (if any healthy) AND at least one “issue” example (if any degraded/error). If nothing degraded/error, say so.
- Choose up to 5 notable_devices (mix of best and worst). Each must include exactly one evidence path that exists for that host.
- For incidents, prefer concise, high-signal patterns (0–3 items). If you cannot provide valid evidence paths, return an empty list rather than guessing.
- Only propose read-only follow-ups (show …) or safe probes (ping/traceroute). Never config/clear/reload/debug/copy/write/monitor.
- Keep all text brief and specific. Paths MUST start with commands.<cmd_key>. and use keys listed for that host when possible.


--- USER ---
```json
{
  "per_device": [
    {
      "hostname": "B-ASBR-1",
      "platform": "ios-xr",
      "signals_seen": [
        "bfd",
        "bgp"
      ],
      "status": "healthy",
      "status_reason": "All BGP neighbors are in the Established state and BFD session is UP.",
      "ok": [
        {
          "summary": "BGP neighbors are all established.",
          "evidence_ref": {
            "command_key": "show_ip_bgp_neighbor_brief",
            "path": "commands.show_ip_bgp_neighbor_brief.data.tables.bgp_neighbors"
          }
        },
        {
          "summary": "BFD session is currently up.",
          "evidence_ref": {
            "command_key": "show_bfd_session",
            "path": "commands.show_bfd_session.data.interface.GigabitEthernet0/0/0/3.dest_ip_address.100.64.231.2.state"
          }
        }
      ],
      "suspect": [],
      "findings": [
        {
          "signal": "bgp",
          "severity": "info",
          "summary": "All BGP neighbors are in the Established state.",
          "evidence_ref": {
            "command_key": "show_ip_bgp_neighbor_brief",
            "path": "commands.show_ip_bgp_neighbor_brief.data.metrics.bgp_neighbors_by_state.established"
          }
        },
        {
          "signal": "bfd",
          "severity": "info",
          "summary": "BFD session is up with expected parameters.",
          "evidence_ref": {
            "command_key": "show_bfd_session_detail",
            "path": "commands.show_bfd_session_detail.data.status.value"
          }
        }
      ],
      "recommended_show_cmds": [
        "show bgp summary",
        "show bfd neighbors"
      ],
      "optional_active_cmds": []
    },
    {
      "hostname": "C-ASBR-1",
      "platform": "ios-xr",
      "signals_seen": [
        "bfd",
        "bgp"
      ],
      "status": "degraded",
      "status_reason": "BGP neighbors show a mix of established and idle states.",
      "ok": [
        {
          "summary": "BFD session is operational and configured correctly.",
          "evidence_ref": {
            "command_key": "show_bfd_session",
            "path": "commands.show_bfd_session.data.interface.GigabitEthernet0/0/0/1.dest_ip_address.100.64.231.1.state"
          }
        }
      ],
      "suspect": [
        {
          "summary": "BGP neighbors show 4 idle and 2 established states.",
          "evidence_ref": {
            "command_key": "show_ip_bgp_neighbor_brief",
            "path": "commands.show_ip_bgp_neighbor_brief.data.metrics.bgp_neighbors_by_state.idle"
          }
        }
      ],
      "findings": [
        {
          "signal": "bgp",
          "severity": "warn",
          "summary": "BGP neighbors are in mixed states with 4 idle neighbors.",
          "evidence_ref": {
            "command_key": "show_ip_bgp_neighbor_brief",
            "path": "commands.show_ip_bgp_neighbor_brief.data.metrics.bgp_neighbors_by_state"
          }
        }
      ],
      "recommended_show_cmds": [
        "show bgp summary",
        "show bfd neighbors"
      ],
      "optional_active_cmds": []
    }
  ],
  "facts_by_host": {
    "B-ASBR-1": "{\"hostname\": \"B-ASBR-1\", \"platform_hint\": \"cisco-ios-xr\", \"signals_seen\": [\"bfd\", \"bgp\"], \"generated_at\": 1758042170, \"facts_version\": 1, \"coverage\": {\"genie_ok\": 1, \"genie_err\": 0, \"llm_ok\": 2, \"total_cmds\": 3, \"total_enriched\": 3}, \"commands\": {\"show_bfd_session\": {\"command\": \"show bfd session\", \"topic\": \"bfd\", \"platform_hint\": \"cisco-ios-xr\", \"source\": \"genie\", \"parsed_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/1-parsed/B-ASBR-1/cisco-ios-xr__show_bfd_session.json\", \"evidence_text_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/0-md-index/B-ASBR-1/002__show_bfd_session.txt\", \"parser_ok\": true, \"data\": {\"interface\": {\"GigabitEthernet0/0/0/3\": {\"dest_ip_address\": {\"100.64.231.2\": {\"echo_total_msec\": 2500, \"echo_msec\": 500, \"echo_multiplier\": 5, \"async_total_msec\": 10000, \"async_msec\": 2000, \"async_multiplier\": 5, \"state\": \"UP\", \"hardware\": \"No\", \"npu\": \"n/a\"}}}}}, \"genie_data\": {\"interface\": {\"GigabitEthernet0/0/0/3\": {\"dest_ip_address\": {\"100.64.231.2\": {\"echo_total_msec\": 2500, \"echo_msec\": 500, \"echo_multiplier\": 5, \"async_total_msec\": 10000, \"async_msec\": 2000, \"async_multiplier\": 5, \"state\": \"UP\", \"hardware\": \"No\", \"npu\": \"n/a\"}}}}}}, \"show_bfd_session_detail\": {\"command\": \"show bfd session detail\", \"topic\": \"bfd\", \"platform_hint\": \"cisco-ios-xr\", \"source\": \"llm\", \"parsed_path\": \"\", \"evidence_text_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/0-md-index/B-ASBR-1/003__show_bfd_session_detail.txt\", \"parser_ok\": false, \"data\": {\"summary\": \"BFD session is currently up with specific parameters and statistics.\", \"status\": {\"name\": \"bfd_session\", \"value\": \"up\", \"confidence\": \"high\", \"confidence_reason\": \"The state is explicitly stated as UP.\"}, \"metrics\": {\"desired_tx_interval_seconds\": 2, \"required_rx_interval_seconds\": 2, \"required_echo_rx_interval_ms\": 1, \"multiplier\": 5, \"async_detection_time_seconds\": 10, \"echo_detection_time_ms\": 2500, \"local_negotiated_async_tx_interval_seconds\": 2, \"remote_negotiated_async_tx_interval_seconds\": 2, \"desired_echo_tx_interval_ms\": 500, \"local_negotiated_echo_tx_interval_ms\": 500, \"last_packet_transmitted_ms\": 1740, \"last_packet_received_ms\": 1687}, \"tables\": {\"timers\": [{\"local_negotiated_async_tx_interval\": \"2 s\", \"remote_negotiated_async_tx_interval\": \"2 s\", \"desired_echo_tx_interval\": \"500 ms\", \"local_negotiated_echo_tx_interval\": \"500 ms\", \"echo_detection_time\": \"2500 ms\", \"async_detection_time\": \"10 s\"}], \"parameters\": [{\"version\": 1, \"desired_tx_interval\": \"2 s\", \"required_rx_interval\": \"2 s\", \"required_echo_rx_interval\": \"1 ms\", \"multiplier\": 5, \"diag\": \"None\", \"my_discr\": 2148532226, \"your_discr\": 2148532226, \"state\": \"UP\", \"d_f_p_c_a\": \"0/0/0/1/0\"}]}, \"evidence\": [\"L5: State: UP for 0d:0h:0m:32s, number of times UP: 1\", \"L6: Session type: PR/V4/SH\", \"L20: Local negotiated async tx interval: 2 s\", \"L21: Remote negotiated async tx interval: 2 s\", \"L22: Desired echo tx interval: 500 ms, local negotiated echo tx interval: 500 ms\"]}, \"llm_data\": {\"summary\": \"BFD session is currently up with specific parameters and statistics.\", \"status\": {\"name\": \"bfd_session\", \"value\": \"up\", \"confidence\": \"high\", \"confidence_reason\": \"The state is explicitly stated as UP.\"}, \"metrics\": {\"desired_tx_interval_seconds\": 2, \"required_rx_interval_seconds\": 2, \"required_echo_rx_interval_ms\": 1, \"multiplier\": 5, \"async_detection_time_seconds\": 10, \"echo_detection_time_ms\": 2500, \"local_negotiated_async_tx_interval_seconds\": 2, \"remote_negotiated_async_tx_interval_seconds\": 2, \"desired_echo_tx_interval_ms\": 500, \"local_negotiated_echo_tx_interval_ms\": 500, \"last_packet_transmitted_ms\": 1740, \"last_packet_received_ms\": 1687}, \"tables\": {\"timers\": [{\"local_negotiated_async_tx_interval\": \"2 s\", \"remote_negotiated_async_tx_interval\": \"2 s\", \"desired_echo_tx_interval\": \"500 ms\", \"local_negotiated_echo_tx_interval\": \"500 ms\", \"echo_detection_time\": \"2500 ms\", \"async_detection_time\": \"10 s\"}], \"parameters\": [{\"version\": 1, \"desired_tx_interval\": \"2 s\", \"required_rx_interval\": \"2 s\", \"required_echo_rx_interval\": \"1 ms\", \"multiplier\": 5, \"diag\": \"None\", \"my_discr\": 2148532226, \"your_discr\": 2148532226, \"state\": \"UP\", \"d_f_p_c_a\": \"0/0/0/1/0\"}]}, \"evidence\": [\"L5: State: UP for 0d:0h:0m:32s, number of times UP: 1\", \"L6: Session type: PR/V4/SH\", \"L20: Local negotiated async tx interval: 2 s\", \"L21: Remote negotiated async tx interval: 2 s\", \"L22: Desired echo tx interval: 500 ms, local negotiated echo tx interval: 500 ms\"]}}, \"show_ip_bgp_neighbor_brief\": {\"command\": \"show ip bgp neighbor brief\", \"topic\": \"bgp\", \"platform_hint\": \"cisco-ios-xr\", \"source\": \"llm\", \"parsed_path\": \"\", \"evidence_text_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/0-md-index/B-ASBR-1/001__show_ip_bgp_neighbor_brief.txt\", \"parser_ok\": false, \"data\": {\"summary\": \"The BGP neighbor summary shows three established IPv4 neighbors and one established IPv6 neighbor.\", \"status\": {\"name\": \"bgp_neighbors\", \"value\": \"established\", \"confidence\": \"high\", \"confidence_reason\": \"All neighbors are in the Established state.\"}, \"metrics\": {\"bgp_neighbors_total\": 4, \"bgp_neighbors_by_state\": {\"established\": 4}}, \"tables\": {\"bgp_neighbors\": [{\"Neighbor\": \"2.0.101.10\", \"Spk\": 0, \"AS\": 200, \"Description\": \"\", \"Up/Down\": \"01:56:52\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"100.64.121.1\", \"Spk\": 0, \"AS\": 100, \"Description\": \"\", \"Up/Down\": \"04:04:52\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"100.64.231.2\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"00:00:34\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"2620:fc7:64:231::2\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"00:00:46\", \"NBRState\": \"Established\"}]}, \"evidence\": [\"L2: 2.0.101.10        0   200                                      01:56:52 Established\", \"L3: 100.64.121.1      0   100                                      04:04:52 Established\", \"L4: 100.64.231.2      0   300                                      00:00:34 Established\", \"L5: 2620:fc7:64:231::2\\n                  0   300                                      00:00:46 Established\"]}, \"llm_data\": {\"summary\": \"The BGP neighbor summary shows three established IPv4 neighbors and one established IPv6 neighbor.\", \"status\": {\"name\": \"bgp_neighbors\", \"value\": \"established\", \"confidence\": \"high\", \"confidence_reason\": \"All neighbors are in the Established state.\"}, \"metrics\": {\"bgp_neighbors_total\": 4, \"bgp_neighbors_by_state\": {\"established\": 4}}, \"tables\": {\"bgp_neighbors\": [{\"Neighbor\": \"2.0.101.10\", \"Spk\": 0, \"AS\": 200, \"Description\": \"\", \"Up/Down\": \"01:56:52\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"100.64.121.1\", \"Spk\": 0, \"AS\": 100, \"Description\": \"\", \"Up/Down\": \"04:04:52\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"100.64.231.2\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"00:00:34\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"2620:fc7:64:231::2\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"00:00:46\", \"NBRState\": \"Established\"}]}, \"evidence\": [\"L2: 2.0.101.10        0   200                                      01:56:52 Established\", \"L3: 100.64.121.1      0   100                                      04:04:52 Established\", \"L4: 100.64.231.2      0   300                                      00:00:34 Established\", \"L5: 2620:fc7:64:231::2\\n                  0   300                                      00:00:46 Established\"]}}}, \"notes\": {\"gap_fill_permitted\": true, \"gap_fill_used\": true, \"providers\": [\"mcp(if-wired)\", \"genie\", \"llm\"]}}",
    "C-ASBR-1": "{\"hostname\": \"C-ASBR-1\", \"platform_hint\": \"cisco-ios-xr\", \"signals_seen\": [\"bfd\", \"bgp\"], \"generated_at\": 1758042200, \"facts_version\": 1, \"coverage\": {\"genie_ok\": 1, \"genie_err\": 0, \"llm_ok\": 2, \"total_cmds\": 3, \"total_enriched\": 3}, \"commands\": {\"show_bfd_session\": {\"command\": \"show bfd session\", \"topic\": \"bfd\", \"platform_hint\": \"cisco-ios-xr\", \"source\": \"genie\", \"parsed_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/1-parsed/C-ASBR-1/cisco-ios-xr__show_bfd_session.json\", \"evidence_text_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/0-md-index/C-ASBR-1/002__show_bfd_session.txt\", \"parser_ok\": true, \"data\": {\"interface\": {\"GigabitEthernet0/0/0/1\": {\"dest_ip_address\": {\"100.64.231.1\": {\"echo_total_msec\": 2500, \"echo_msec\": 500, \"echo_multiplier\": 5, \"async_total_msec\": 10000, \"async_msec\": 2000, \"async_multiplier\": 5, \"state\": \"UP\", \"hardware\": \"No\", \"npu\": \"n/a\"}}}}}, \"genie_data\": {\"interface\": {\"GigabitEthernet0/0/0/1\": {\"dest_ip_address\": {\"100.64.231.1\": {\"echo_total_msec\": 2500, \"echo_msec\": 500, \"echo_multiplier\": 5, \"async_total_msec\": 10000, \"async_msec\": 2000, \"async_multiplier\": 5, \"state\": \"UP\", \"hardware\": \"No\", \"npu\": \"n/a\"}}}}}}, \"show_bfd_session_detail\": {\"command\": \"show bfd session detail\", \"topic\": \"bfd\", \"platform_hint\": \"cisco-ios-xr\", \"source\": \"llm\", \"parsed_path\": \"\", \"evidence_text_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/0-md-index/C-ASBR-1/003__show_bfd_session_detail.txt\", \"parser_ok\": false, \"data\": {\"summary\": \"The BFD session is currently up with specific parameters and statistics.\", \"status\": {\"name\": \"bfd_session\", \"value\": \"up\", \"confidence\": \"high\", \"confidence_reason\": \"The state is explicitly stated as UP in the output.\"}, \"metrics\": {\"desired_tx_interval_seconds\": 2, \"required_rx_interval_seconds\": 2, \"required_echo_rx_interval_ms\": 1, \"async_detection_time_seconds\": 10, \"echo_detection_time_ms\": 2500, \"local_negotiated_async_tx_interval_seconds\": 2, \"remote_negotiated_async_tx_interval_seconds\": 2, \"desired_echo_tx_interval_ms\": 500, \"local_negotiated_echo_tx_interval_ms\": 500, \"last_packet_transmitted_ms_ago\": 1562, \"last_packet_received_ms_ago\": 1671}, \"tables\": {\"parameters\": [{\"Version\": \"1\", \"desired_tx_interval\": \"2 s\", \"required_rx_interval\": \"2 s\", \"required_echo_rx_interval\": \"1 ms\", \"multiplier\": \"5\", \"diag\": \"None\"}], \"timers\": [{\"local_negotiated_async_tx_interval\": \"2 s\", \"remote_negotiated_async_tx_interval\": \"2 s\", \"desired_echo_tx_interval\": \"500 ms\", \"local_negotiated_echo_tx_interval\": \"500 ms\", \"echo_detection_time\": \"2500 ms(500 ms*5)\", \"async_detection_time\": \"10 s(2 s*5)\"}], \"local_stats\": [{\"async_tx_intervals\": {\"number_of_intervals\": 17, \"min\": \"2 ms\", \"max\": \"1956 ms\", \"avg\": \"1719 ms\"}, \"last_packet_transmitted\": \"1562 ms ago\", \"async_rx_intervals\": {\"number_of_intervals\": 17, \"min\": \"3 ms\", \"max\": \"1959 ms\", \"avg\": \"1712 ms\"}, \"last_packet_received\": \"1671 ms ago\", \"echo_tx_intervals\": {\"number_of_intervals\": 0, \"min\": \"0 s\", \"max\": \"0 s\", \"avg\": \"0 s\"}, \"last_echo_packet_transmitted\": \"279 ms ago\", \"echo_rx_intervals\": {\"number_of_intervals\": 0, \"min\": \"0 s\", \"max\": \"0 s\", \"avg\": \"0 s\"}, \"latency_of_echo_packets\": {\"number_of_packets\": 0, \"min\": \"0 ms\", \"max\": \"0 ms\", \"avg\": \"0 ms\"}}]}, \"evidence\": [\"L5: State: UP for 0d:0h:0m:30s, number of times UP: 1\", \"L6: Session type: PR/V4/SH\", \"L7: My discr: 2148532226, your discr: 2148532226, state UP\", \"L8: Local negotiated async tx interval: 2 s\", \"L9: Remote negotiated async tx interval: 2 s\"]}, \"llm_data\": {\"summary\": \"The BFD session is currently up with specific parameters and statistics.\", \"status\": {\"name\": \"bfd_session\", \"value\": \"up\", \"confidence\": \"high\", \"confidence_reason\": \"The state is explicitly stated as UP in the output.\"}, \"metrics\": {\"desired_tx_interval_seconds\": 2, \"required_rx_interval_seconds\": 2, \"required_echo_rx_interval_ms\": 1, \"async_detection_time_seconds\": 10, \"echo_detection_time_ms\": 2500, \"local_negotiated_async_tx_interval_seconds\": 2, \"remote_negotiated_async_tx_interval_seconds\": 2, \"desired_echo_tx_interval_ms\": 500, \"local_negotiated_echo_tx_interval_ms\": 500, \"last_packet_transmitted_ms_ago\": 1562, \"last_packet_received_ms_ago\": 1671}, \"tables\": {\"parameters\": [{\"Version\": \"1\", \"desired_tx_interval\": \"2 s\", \"required_rx_interval\": \"2 s\", \"required_echo_rx_interval\": \"1 ms\", \"multiplier\": \"5\", \"diag\": \"None\"}], \"timers\": [{\"local_negotiated_async_tx_interval\": \"2 s\", \"remote_negotiated_async_tx_interval\": \"2 s\", \"desired_echo_tx_interval\": \"500 ms\", \"local_negotiated_echo_tx_interval\": \"500 ms\", \"echo_detection_time\": \"2500 ms(500 ms*5)\", \"async_detection_time\": \"10 s(2 s*5)\"}], \"local_stats\": [{\"async_tx_intervals\": {\"number_of_intervals\": 17, \"min\": \"2 ms\", \"max\": \"1956 ms\", \"avg\": \"1719 ms\"}, \"last_packet_transmitted\": \"1562 ms ago\", \"async_rx_intervals\": {\"number_of_intervals\": 17, \"min\": \"3 ms\", \"max\": \"1959 ms\", \"avg\": \"1712 ms\"}, \"last_packet_received\": \"1671 ms ago\", \"echo_tx_intervals\": {\"number_of_intervals\": 0, \"min\": \"0 s\", \"max\": \"0 s\", \"avg\": \"0 s\"}, \"last_echo_packet_transmitted\": \"279 ms ago\", \"echo_rx_intervals\": {\"number_of_intervals\": 0, \"min\": \"0 s\", \"max\": \"0 s\", \"avg\": \"0 s\"}, \"latency_of_echo_packets\": {\"number_of_packets\": 0, \"min\": \"0 ms\", \"max\": \"0 ms\", \"avg\": \"0 ms\"}}]}, \"evidence\": [\"L5: State: UP for 0d:0h:0m:30s, number of times UP: 1\", \"L6: Session type: PR/V4/SH\", \"L7: My discr: 2148532226, your discr: 2148532226, state UP\", \"L8: Local negotiated async tx interval: 2 s\", \"L9: Remote negotiated async tx interval: 2 s\"]}}, \"show_ip_bgp_neighbor_brief\": {\"command\": \"show ip bgp neighbor brief\", \"topic\": \"bgp\", \"platform_hint\": \"cisco-ios-xr\", \"source\": \"llm\", \"parsed_path\": \"\", \"evidence_text_path\": \"/app/doo/configs.5/task-18.bfd/agent7/3-analyze/0-md-index/C-ASBR-1/001__show_ip_bgp_neighbor_brief.txt\", \"parser_ok\": false, \"data\": {\"summary\": \"The BGP neighbor status shows a mix of established and idle states.\", \"status\": {\"name\": \"bgp_neighbors\", \"value\": \"mixed\", \"confidence\": \"high\", \"confidence_reason\": \"There are both established and idle neighbors.\"}, \"metrics\": {\"bgp_neighbors_total\": 6, \"bgp_neighbors_by_state\": {\"idle\": 4, \"established\": 2}}, \"tables\": {\"bgp_neighbors\": [{\"Neighbor\": \"3.0.101.1\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"3.0.101.2\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"3.0.101.3\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"3.0.101.4\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"100.64.231.1\", \"Spk\": 0, \"AS\": 200, \"Description\": \"\", \"Up/Down\": \"00:00:32\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"2620:fc7:64:231::1\", \"Spk\": 0, \"AS\": 200, \"Description\": \"\", \"Up/Down\": \"00:00:45\", \"NBRState\": \"Established\"}]}, \"evidence\": [\"L4: 3.0.101.1         0   300                                         2d19h Idle\", \"L5: 3.0.101.2         0   300                                         2d19h Idle\", \"L6: 3.0.101.3         0   300                                         2d19h Idle\", \"L7: 3.0.101.4         0   300                                         2d19h Idle\", \"L8: 100.64.231.1      0   200                                      00:00:32 Established\", \"L9: 2620:fc7:64:231::1\\n                  0   200                                      00:00:45 Established\"]}, \"llm_data\": {\"summary\": \"The BGP neighbor status shows a mix of established and idle states.\", \"status\": {\"name\": \"bgp_neighbors\", \"value\": \"mixed\", \"confidence\": \"high\", \"confidence_reason\": \"There are both established and idle neighbors.\"}, \"metrics\": {\"bgp_neighbors_total\": 6, \"bgp_neighbors_by_state\": {\"idle\": 4, \"established\": 2}}, \"tables\": {\"bgp_neighbors\": [{\"Neighbor\": \"3.0.101.1\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"3.0.101.2\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"3.0.101.3\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"3.0.101.4\", \"Spk\": 0, \"AS\": 300, \"Description\": \"\", \"Up/Down\": \"2d19h\", \"NBRState\": \"Idle\"}, {\"Neighbor\": \"100.64.231.1\", \"Spk\": 0, \"AS\": 200, \"Description\": \"\", \"Up/Down\": \"00:00:32\", \"NBRState\": \"Established\"}, {\"Neighbor\": \"2620:fc7:64:231::1\", \"Spk\": 0, \"AS\": 200, \"Description\": \"\", \"Up/Down\": \"00:00:45\", \"NBRState\": \"Established\"}]}, \"evidence\": [\"L4: 3.0.101.1         0   300                                         2d19h Idle\", \"L5: 3.0.101.2         0   300                                         2d19h Idle\", \"L6: 3.0.101.3         0   300                                         2d19h Idle\", \"L7: 3.0.101.4         0   300                                         2d19h Idle\", \"L8: 100.64.231.1      0   200                                      00:00:32 Established\", \"L9: 2620:fc7:64:231::1\\n                  0   200                                      00:00:45 Established\"]}}}, \"notes\": {\"gap_fill_permitted\": true, \"gap_fill_used\": true, \"providers\": [\"mcp(if-wired)\", \"genie\", \"llm\"]}}"
  },
  "available_command_keys_by_host": {
    "B-ASBR-1": [
      "show_bfd_session",
      "show_bfd_session_detail",
      "show_ip_bgp_neighbor_brief"
    ],
    "C-ASBR-1": [
      "show_bfd_session",
      "show_bfd_session_detail",
      "show_ip_bgp_neighbor_brief"
    ]
  }
}
```
