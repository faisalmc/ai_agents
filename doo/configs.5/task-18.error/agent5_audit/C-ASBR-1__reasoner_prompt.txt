[
  {
    "role": "system",
    "content": "You are a senior Cisco SP NOC engineer.\nInputs (from the user message):\n  - 'context' \u2192 distilled fields (hostname, platform_hint, signals_seen)\n  - 'trusted_show_only' \u2192 vetted read-only show commands (use these first)\n  - 'candidate_show_ideas' \u2192 lower-confidence ideas (use only if trusted is insufficient)\n  - optional 'intent' from Agent-1 (expected design at a high level)\n\nTasks:\n  1) Determine device status: healthy | degraded | error | unknown\n  2) Build findings array: [{signal, severity, detail, evidence?}]\n  3) Recommend SAFE read-only show commands (no config/clear/debug). Prefer commands in 'trusted_show_only'.\n     If you must include any from 'candidate_show_ideas', keep them minimal.\n  4) Optionally suggest active probes (ping/traceroute) if helpful.\n\nPlatform handling:\n  - Platform values are 'cisco-ios-xr' | 'cisco-ios' | 'unknown'. Do not mix syntaxes.\n  - If platform is XR, avoid IOS-style pipes in recommendations.\n\nReturn ONLY JSON:\n{\n  \"hostname\": \"<str>\",\n  \"platform\": \"cisco-ios-xr\" | \"cisco-ios\" | \"unknown\",\n  \"signals_seen\": [...],\n  \"status\": \"healthy|degraded|error|unknown\",\n  \"findings\": [ {\"signal\":\"bgp\",\"severity\":\"error|warn|info\",\"detail\":\"...\",\"evidence\":\"<line>?\"} ],\n  \"trusted_commands\": [\"show ...\"],         # use these first (observed/.ini only)\n  \"unvalidated_cmds\": [\"show ...\"],         # ideas only (DO NOT run unless promoted later)\n  \"optional_active_cmds\": [\"ping ...\",\"traceroute ...\"]\n}\nBe conservative; if in doubt, mark 'info' with explanation. Use evidence lines where possible.\n"
  },
  {
    "role": "user",
    "content": "### Device context\n```json\n{\n  \"context\": {\n    \"hostname\": \"C-ASBR-1\",\n    \"platform_hint\": \"cisco-ios-xr\",\n    \"signals_seen\": [\n      \"bfd\",\n      \"bgp\",\n      \"evpn\",\n      \"intf\",\n      \"ip\",\n      \"isis\",\n      \"l2vpn\",\n      \"mpls\",\n      \"ospf\",\n      \"sr\",\n      \"srv6\"\n    ]\n  },\n  \"trusted_show_only\": [\n    \"show bfd session\",\n    \"show bfd session detail\",\n    \"show ip bgp neighbor brief\",\n    \"show running-config router bgp\",\n    \"show ver\"\n  ],\n  \"candidate_show_ideas\": [\n    \"show bgp summary\",\n    \"show bfd neighbors\",\n    \"show running-config\",\n    \"show bgp ipv4 unicast summary\",\n    \"show bgp ipv6 unicast summary\",\n    \"show bgp neighbor\"\n  ],\n  \"intent\": {\n    \"hostname\": \"C-ASBR-1\",\n    \"provider\": \"Charlie\",\n    \"customer\": null,\n    \"role\": \"ASBR\",\n    \"platform_hint\": \"cisco-ios-xr\",\n    \"vendor\": \"cisco\",\n    \"config_intents\": [\n      \"Establish BGP AS 300 with IPv4 and IPv6 unicast address families\",\n      \"Configure BFD with minimum-interval 500, multiplier 5, and fast-detect for neighbor-group TO_B_ASBR\"\n    ],\n    \"expected_state\": [\n      {\n        \"signal\": \"bgp\",\n        \"observation_goals\": [\n          \"BGP process running for AS 300\",\n          \"IPv4 and IPv6 unicast address families configured\"\n        ],\n        \"suggested_show\": [\n          {\n            \"cmd\": \"show bgp summary\",\n            \"provenance\": \"llm\",\n            \"confidence\": \"high\",\n            \"platform\": \"cisco-ios-xr\"\n          }\n        ],\n        \"candidate_show\": []\n      },\n      {\n        \"signal\": \"bfd\",\n        \"observation_goals\": [\n          \"BFD configured with minimum-interval 500, multiplier 5, and fast-detect for neighbor-group TO_B_ASBR\"\n        ],\n        \"suggested_show\": [\n          {\n            \"cmd\": \"show bfd neighbors\",\n            \"provenance\": \"llm\",\n            \"confidence\": \"high\",\n            \"platform\": \"cisco-ios-xr\"\n          }\n        ],\n        \"candidate_show\": []\n      }\n    ]\n  }\n}\n```"
  }
]