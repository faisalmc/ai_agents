--- SYSTEM ---
You are a senior Cisco SP NOC engineer.
You will receive:
  • Optional JSON from Agent‑1 summarizing intended configuration for this host
  • CLI show-output captured in a Markdown (.md) file for this host (IOS or IOS‑XR)
Your tasks:
  1) Determine platform ("ios-xr" or "ios") if possible from the log, else "unknown".
  2) From the log ONLY, assess health for protocols/features that appear (BGP, EVPN/L2VPN,
     ISIS/OSPF, SR/SRv6, MPLS, interface/port-channel, reachability).
  3) If intent JSON is provided, use it as context for *expected* state, but do NOT invent facts
     not visible in the log.
  4) Return a single JSON object with fields:
     {
       "hostname": "<string>",
       "platform": "ios-xr" | "ios" | "unknown",
       "signals_seen": ["bgp","evpn","isis","mpls","sr","l2vpn","intf","ip", ...],
       "status": "healthy" | "degraded" | "error" | "unknown",
       "findings": [ {"signal":"bgp","severity":"warn|error|info","detail":"..."} , ... ],
       "recommended_show_cmds": [ "show ...", ... ],   // safe, read-only
       "optional_active_cmds": [ "ping ...", "traceroute ..." ]  // optional probes only
     }
  5) NEVER include config/clear/reload/debug commands in either list.
  6) Be conservative: if signal is unclear, mark severity "info" and explain.
  7) Only report signals that are evidenced by the provided log text, agent‑1 intents, or show_cmds.ini. Do not infer protocols that are not visible.
  8) If `ground_evidence_facts` contains a condition (e.g., interface CLNS=Down, BGP neighbor=Idle/Active), you MUST surface a corresponding finding with the evidence reference.

Output ONLY the JSON object.
Prefer recommending follow-up 'show' commands that are already present in show_cmds.ini; add at most 3 new 'show' commands only if clearly warranted by the findings. Never suggest config/debug/clear.
Do not mention devices other than the current hostname. If a signal is not evidenced in the log/context, exclude it.


--- USER ---
### Context (JSON)
```json
{
  "hostname": "A-P-4",
  "platform_hint": "ios-xr",
  "focus_signals": [
    "bgp",
    "intf",
    "ip",
    "mpls"
  ],
  "allow_active_probes": false,
  "agent1_summary": {
    "hostname": "A-P-4",
    "provider": "Alpha",
    "customer": null,
    "role": "Provider",
    "platform_hint": "cisco-ios-xr",
    "vendor": "cisco",
    "config_intents": [
      "Run BGP AS 100 with IPv4 unicast for core reachability",
      "Use Loopback0 as update-source for BGP neighbors",
      "Implement route reflector functionality for specific neighbors",
      "Advertise 1.0.101.8/32 with label via route-policy"
    ],
    "expected_state": [
      {
        "signal": "bgp",
        "observation_goals": [
          "BGP process is running",
          "BGP router-ID is set to 1.0.101.8",
          "Core neighbors should be Established",
          "AFI/SAFI ipv4 labeled-unicast active"
        ],
        "suggested_show": [
          {
            "cmd": "show bgp summary",
            "provenance": "llm",
            "confidence": "high",
            "platform": "cisco-ios-xr"
          },
          {
            "cmd": "show bgp ipv4 labeled-unicast summary",
            "provenance": "llm",
            "confidence": "med",
            "platform": "cisco-ios-xr"
          }
        ],
        "candidate_show": [
          {
            "cmd": "show run | section ^router bgp",
            "provenance": "llm",
            "confidence": "low",
            "platform": "cisco-ios-xr",
            "note": "IOS-style pipe may not work on XR"
          }
        ]
      },
      {
        "signal": "bgp",
        "observation_goals": [
          "IBGP policy 'out enforce-modifications' is applied",
          "1.0.101.8/32 is advertised with label",
          "Next-hop-self configured for RR and RR_CLIENT neighbors",
          "RR_CLIENT neighbors are route reflector clients"
        ],
        "suggested_show": [
          {
            "cmd": "show run | sec router bgp",
            "provenance": "llm",
            "confidence": "high",
            "platform": "cisco-ios-xr"
          }
        ],
        "candidate_show": [
          {
            "cmd": "show bgp ipv4 unicast neighbors",
            "provenance": "llm",
            "confidence": "med",
            "platform": "cisco-ios-xr",
            "note": "Specific neighbor details"
          }
        ]
      }
    ]
  },
  "show_cmds_ini": [
    "show run router bgp",
    "show bgp neighbors brief",
    "show bgp ipv4 labeled-unicast",
    "show mpls forwarding",
    "show run | sec bgp",
    "show bgp ipv4 labeled-unicast 1.0.101.7",
    "show bgp ipv4 labeled-unicast 1.0.101.9"
  ],
  "ground_evidence_facts": {
    "hostname": "A-P-4",
    "platform_hint": "cisco-ios-xr",
    "signals_seen": [
      "bgp",
      "evpn",
      "intf",
      "ip",
      "isis",
      "l2vpn",
      "mpls",
      "ospf",
      "sr",
      "srv6"
    ],
    "trusted_from_observed": [
      "show bgp ipv4 labeled-unicast",
      "show bgp ipv4 labeled-unicast 1.0.101.7",
      "show bgp ipv4 labeled-unicast 1.0.101.9",
      "show bgp neighbors brief",
      "show mpls forwarding",
      "show running-config router bgp",
      "show running-config"
    ],
    "trusted_from_agent1": [],
    "trusted_all": [
      "show bgp ipv4 labeled-unicast",
      "show bgp ipv4 labeled-unicast 1.0.101.7",
      "show bgp ipv4 labeled-unicast 1.0.101.9",
      "show bgp neighbors brief",
      "show mpls forwarding",
      "show running-config router bgp",
      "show running-config"
    ],
    "candidates_from_agent1": [
      "show bgp summary",
      "show bgp ipv4 labeled-unicast summary",
      "show running-config",
      "show running-config",
      "show bgp ipv4 unicast neighbors"
    ],
    "ideas_from_lexicon": [
      "show running-config router isis",
      "show isis neighbors",
      "show bgp ipv4 unicast summary vrf YELLOW",
      "show bgp ipv6 unicast summary vrf YELLOW",
      "show bgp summary",
      "show bgp vrf YELLOW",
      "show bgp vrf YELLOW summary",
      "show ospf vrf YELLOW",
      "show running-config interface GigabitEthernet0/0/0/4",
      "show running-config router bgp vrf YELLOW",
      "show running-config router ospf vrf YELLOW",
      "show running-config",
      "show policy-map interface GigabitEthernet0/0/0/1 output",
      "show class-map",
      "show policy-map",
      "show bgp vrf YELLOW neighbors",
      "show running-config",
      "show bgp mvpn all",
      "show ip pim interface",
      "show ip pim ssm range",
      "show multicast",
      "show running-config interface GigabitEthernet 0/0/0/0",
      "show running-config interface GigabitEthernet 0/0/0/1",
      "show running-config interface GigabitEthernet 0/0/0/2",
      "show running-config interface loopback0",
      "show running-config multicast-routing",
      "show running-config mvpn",
      "show running-config router pim",
      "show running-config vrf YELLOW",
      "show running-config vrf YELLOW",
      "show running-config",
      "show ip mroute",
      "show running-config multicast",
      "show running-config router bgp 200",
      "show bfd neighbors",
      "show bgp ipv4 unicast summary",
      "show bgp ipv6 unicast summary",
      "show running-config router bgp 200",
      "show mpls lsd",
      "show running-config interface Loopback0",
      "show running-config router isis AGG2",
      "show running-config",
      "show management-plane security",
      "show bgp vrf BLUE neighbors 10.10.2.2",
      "show bgp vrf BLUE neighbors 10.10.2.2 received-routes",
      "show running-config",
      "show bgp ipv4 labeled-unicast summary",
      "show running",
      "show running-config interface GigabitEthernet0/0/0/0",
      "show running-config interface GigabitEthernet0/0/0/1",
      "show running-config router isis CORE",
      "show running-config router bgp 300",
      "show bgp neighbor-group TO_C_ASBR",
      "show bgp neighbor",
      "show bgp neighbor-group TO_B_ASBR",
      "show ip route 1.0.101.1/32",
      "show bgp ipv4 unicast neighbors"
    ],
    "candidates_all": [
      "show bgp summary",
      "show bgp ipv4 labeled-unicast summary",
      "show bgp ipv4 unicast neighbors",
      "show running-config router isis",
      "show isis neighbors",
      "show bgp ipv4 unicast summary vrf YELLOW",
      "show bgp ipv6 unicast summary vrf YELLOW",
      "show bgp vrf YELLOW",
      "show bgp vrf YELLOW summary",
      "show ospf vrf YELLOW",
      "show running-config interface GigabitEthernet0/0/0/4",
      "show running-config router bgp vrf YELLOW",
      "show running-config router ospf vrf YELLOW",
      "show policy-map interface GigabitEthernet0/0/0/1 output",
      "show class-map",
      "show policy-map",
      "show bgp vrf YELLOW neighbors",
      "show bgp mvpn all",
      "show ip pim interface",
      "show ip pim ssm range",
      "show multicast",
      "show running-config interface GigabitEthernet 0/0/0/0",
      "show running-config interface GigabitEthernet 0/0/0/1",
      "show running-config interface GigabitEthernet 0/0/0/2",
      "show running-config interface loopback0",
      "show running-config multicast-routing",
      "show running-config mvpn",
      "show running-config router pim",
      "show running-config vrf YELLOW",
      "show ip mroute",
      "show running-config multicast",
      "show running-config router bgp 200",
      "show bfd neighbors",
      "show bgp ipv4 unicast summary",
      "show bgp ipv6 unicast summary",
      "show mpls lsd",
      "show running-config interface Loopback0",
      "show running-config router isis AGG2",
      "show management-plane security",
      "show bgp vrf BLUE neighbors 10.10.2.2",
      "show bgp vrf BLUE neighbors 10.10.2.2 received-routes",
      "show running",
      "show running-config interface GigabitEthernet0/0/0/0",
      "show running-config interface GigabitEthernet0/0/0/1",
      "show running-config router isis CORE",
      "show running-config router bgp 300",
      "show bgp neighbor-group TO_C_ASBR",
      "show bgp neighbor",
      "show bgp neighbor-group TO_B_ASBR",
      "show ip route 1.0.101.1/32"
    ],
    "source_counts": {
      "observed": 7,
      "agent1_suggested": 0,
      "agent1_candidates": 5,
      "lexicon_candidates": 57,
      "trusted_total": 7,
      "candidates_total": 50
    },
    "md_len": 6858,
    "facts": {
      "bgp_neighbors": [],
      "evpn_xconnects": [],
      "lacp_bundles": [],
      "reachability": []
    }
  }
}
```

### Device Log (Markdown)
```md
# Grading Output for Task taREMOVED3
**Device:** A-P-4 (192.168.100.108)
_Generated: 2025-08-26 16:46:53.277028_

## show bgp neighbors brief

```
show bgp neighbors brief

Tue Aug 26 16:46:33.680 UTC

Neighbor         Spk    AS  Description                         Up/Down  NBRState
1.0.101.4         0   100                                         1d06h Established 
1.0.101.9         0   100                                         1d06h Established 
1.0.101.10        0   100                                         1d06h Established 
1.0.101.11        0   100                                         1d06h Established 
1.0.101.12        0   100                                         1d06h Established 
RP/0/RP0/CPU0:A-P-4#
```

## show bgp ipv4 labeled-unicast

```
show bgp ipv4 labeled-unicast

Tue Aug 26 16:46:33.803 UTC
BGP router identifier 1.0.101.8, local AS number 100
BGP generic scan interval 60 secs
Non-stop routing is enabled
BGP table state: Active
Table ID: 0xe0000000   RD version: 26
BGP table nexthop route policy: 
BGP main routing table version 26
BGP NSR Initial initsync version 10 (Reached)
BGP NSR/ISSU Sync-Group versions 0/0
BGP scan interval 60 secs

Status codes: s suppressed, d damped, h history, * valid, > best
              i - internal, r RIB-failure, S stale, N Nexthop-discard
Origin codes: i - IGP, e - EGP, ? - incomplete
   Network            Next Hop            Metric LocPrf Weight Path
*>i1.0.101.1/32       1.0.101.6                0    100      0 i
* i                   1.0.101.6                0    100      0 i
*>i1.0.101.2/32       1.0.101.6                0    100      0 i
* i                   1.0.101.6                0    100      0 i
*>i1.0.101.3/32       1.0.101.6                0    100      0 i
* i                   1.0.101.6                0    100      0 i
*>i1.0.101.4/32       1.0.101.4                0    100      0 i
*>i1.0.101.6/32       1.0.101.6                0    100      0 i
* i                   1.0.101.6                0    100      0 i
*>i1.0.101.7/32       1.0.101.7                0    100      0 i
* i                   1.0.101.7                0    100      0 i
*> 1.0.101.8/32       0.0.0.0                  0         32768 i
* i1.0.101.9/32       1.0.101.9                0    100      0 i
*>i                   1.0.101.7                0    100      0 i
* i                   1.0.101.7                0    100      0 i
*>i1.0.101.10/32      1.0.101.10               0    100      0 i

Processed 9 prefixes, 16 paths
RP/0/RP0/CPU0:A-P-4#
```

## show mpls forwarding

```
show mpls forwarding

Tue Aug 26 16:46:33.948 UTC
Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       
Label  Label       or ID              Interface                    Switched    
------ ----------- ------------------ ------------ --------------- ------------
16001  16001       SR Pfx (idx 1)                  1.0.101.6       0           
16002  16002       SR Pfx (idx 2)                  1.0.101.6       0           
16003  16003       SR Pfx (idx 3)                  1.0.101.6       0           
16004  Pop         SR Pfx (idx 4)     Gi0/0/0/4    1.0.23.1        363077      
16006  Pop         SR Pfx (idx 6)     Gi0/0/0/1    1.0.31.1        0           
16007  Pop         SR Pfx (idx 7)     Gi0/0/0/2    1.0.34.1        180358      
16008  Aggregate   SR Pfx (idx 8)     default                      0           
16009  16009       SR Pfx (idx 9)     Gi0/0/0/0    1.0.51.1        181642      
16010  Pop         SR Pfx (idx 10)    Gi0/0/0/0    1.0.51.1        177575      
17004  Pop         SR Pfx (idx 1004)  Gi0/0/0/4    fe80::5054:ff:fe7f:ac62   \
                                                                   0           
17006  Pop         SR Pfx (idx 1006)  Gi0/0/0/1    fe80::5054:ff:feca:8b79   \
                                                                   0           
17007  Pop         SR Pfx (idx 1007)  Gi0/0/0/2    fe80::5054:ff:fe05:dda7   \
                                                                   0           
17008  Aggregate   SR Pfx (idx 1008)  default                      0           
17009  17009       SR Pfx (idx 1009)  Gi0/0/0/0    fe80::5054:ff:fe57:46ea   \
                                                                   0           
17010  Pop         SR Pfx (idx 1010)  Gi0/0/0/0    fe80::5054:ff:fe57:46ea   \
                                                                   0           
24000  Pop         SR Adj (idx 1)     Gi0/0/0/4    1.0.23.1        0           
24001  Pop         SR Adj (idx 3)     Gi0/0/0/4    1.0.23.1        0           
24002  Pop         SR Adj (idx 1)     Gi0/0/0/0    1.0.51.1        0           
24003  Pop         SR Adj (idx 3)     Gi0/0/0/0    1.0.51.1        0           
24004  Pop         SR Adj (idx 1)     Gi0/0/0/4    fe80::5054:ff:fe7f:ac62   \
                                                                   0           
24005  Pop         SR Adj (idx 3)     Gi0/0/0/4    fe80::5054:ff:fe7f:ac62   \
                                                                   0           
24006  Pop         SR Adj (idx 1)     Gi0/0/0/0    fe80::5054:ff:fe57:46ea   \
                                                                   0           
24007  Pop         SR Adj (idx 3)     Gi0/0/0/0    fe80::5054:ff:fe57:46ea   \
                                                                   0           
24008  Pop         SR Adj (idx 1)     Gi0/0/0/1    1.0.31.1        0           
24009  Pop         SR Adj (idx 3)     Gi0/0/0/1    1.0.31.1        0           
24010  Pop         SR Adj (idx 1)     Gi0/0/0/2    1.0.34.1        0           
24011  Pop         SR Adj (idx 3)     Gi0/0/0/2    1.0.34.1        0           
24012  Pop         SR Adj (idx 1)     Gi0/0/0/3    1.0.35.1        0           
24013  Pop         SR Adj (idx 3)     Gi0/0/0/3    1.0.35.1        0           
24014  Pop         SR Adj (idx 1)     Gi0/0/0/1    fe80::5054:ff:feca:8b79   \
                                                                   0           
24015  Pop         SR Adj (idx 3)     Gi0/0/0/1    fe80::5054:ff:feca:8b79   \
                                                                   0           
24016  Pop         SR Adj (idx 1)     Gi0/0/0/2    fe80::5054:ff:fe05:dda7   \
                                                                   0           
24017  Pop         SR Adj (idx 3)     Gi0/0/0/2    fe80::5054:ff:fe05:dda7   \
                                                                   0           
24018  Pop         SR Adj (idx 1)     Gi0/0/0/3    fe80::5054:ff:fee3:e3d   \
                                                                   0           
24019  Pop         SR Adj (idx 3)     Gi0/0/0/3    fe80::5054:ff:fee3:e3d   \
                                                                   0           
RP/0/RP0/CPU0:A-P-4#
```


```
